# 关于linux扩充分区的随笔


## 简介

之前给`OpenMediaVault`的硬盘空间不够大， 新增硬盘似乎不太方便， 就考虑扩大硬盘空间， 踩了坑之后终于弄好了。

有下面的要点， 先简单提一下。

- MBR 分区表最大**只能支持2TB** 空间大小
- GPT 分区表能支持 **大于2TB** 的空间
- `fdisk` 这个工具似乎也只能支持2TB 空间大小
- `parted` 这个工具支持大于2TB 空间的



## 流程



大概思路有两个，如下所说。

---

使用 `fdisk` 的操作流程。

1. **谨慎操作， 这个流程有可能让你的数据全部丢失！**
2. 查看原有分区的 扇区数， 并记录起始扇区位置。一个磁盘只有一个分区的话，起始位置一般是2048 。
3. 确保要扩充的分区后面**没有**别的分区， 否则建议新建一个分区。
4. 删除要扩充的分区。
5. 新建一个同类型的分区
6. 起始扇区位置 和前面查询到的 要保持一致。 **一定要保持一致，否则数据会丢**
7. 结束扇区填写， 好像可以填写具体的大小(500G这种)。  给的默认结束扇区应该是整个磁盘的空间（前提是空间小于2TB）
8. 保存 并写入分区表 
9. `resize2fs` 命令 把分区同步到文件系统。

---

使用`parted`命令 （**建议**）

1. 输入命令 `parted [dev]`   dev 表示设备位置,一般是 `/dev/sdx`
2. `print` 查看磁盘分区表
3. `resizepart 1 Y 3848GB`  命令扩大1号分区的空间大小
   1. `1` 按需填写位置
   2. `Y` 表示自动确认
   3. `3848GB` 表示具体大小
4. `quit` 退出即可。  上一部应该会自动写入分区表
5. 可查看空间大小有无更新， 没有的话可以尝试`resize2fs` 更新一下

---

> 作者: Aincvy  
> URL: https://fantasyplayer.link/periphery/%E5%85%B3%E4%BA%8Elinux%E6%89%A9%E5%85%85%E5%88%86%E5%8C%BA%E7%9A%84%E9%9A%8F%E7%AC%94/  


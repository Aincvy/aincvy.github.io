# Esxi显卡直通的操作


这个是一个不是很难的操作， 但是执行起来可能需要踩一些坑。

### ESXi 的操作

登录后台，点击管理， 找到硬件， 把显卡和 显卡的HDMI 音频都切换直通， 之后重启(*重新引导*)ESXi 主机。

把显卡和显卡的HDMI 音频设备添加到虚拟机里面。（*编辑 / 添加 PCI-E设备*）

编辑虚拟机的配置， 添加或者设置 这个配置项： `hypervisor.cpuid.v0 = FALSE`



### 虚拟机的操作

打开虚拟机， 进入系统，关闭和禁用`vm-tools`  （这个会阻碍显卡驱动）

安装显卡驱动， 重启。

如果是 Windows 系统， 可以考虑使用 `远程桌面链接`这个工具链接系统， 查看显卡驱动有无成功安装。

局域网设备也可以考虑`AnyDesk` 这个工具。

安装显卡驱动的时候可能没那么容易成功。。。 需要点耐心。

~~如果打不开虚拟机或者全部弄好了之后，可以考虑使用 `vga.present = FALSE` 禁用 ESXi提供的显卡。~~ 加了之后我就打不开了。。。  不知道为啥:joy::joy::joy:



至此，应该 就可以正常使用了。 



### 游戏体验

笔者直通了一个AMD的 R9 270，实测的话， 尝试玩了下面几个游戏。

DNF 是可以玩的， 无论是单机版，还是官网版本都是可以玩的。  *听说 DNF 不吃显卡， 不知道是不是真的。*

洛奇英雄传单机版。  这个我是使用 anydesk 远程链接的， 鼠标操作有问题， 就稍微玩了一下。 

steam 有一个家用流式传输的功能， 可以远程玩一些游戏。 并且这个功能可以串流非 steam 库的游戏，笔者当初好像使用了这个功能玩洛奇的单机版， 应该是可以玩的。

*包含启动器之类的游戏好像是玩不了的， 比如 LOL。*

### 远程链接出现的分辨率问题

当初在完成显卡直通后，笔者还碰到了一个分辨率的问题，在使用anydesk远程连接的时候，分辨率最高好像只有 1600x900。 

之后，笔者买了一个hdmi dummy plug，一个欺骗显卡，让显卡觉得它已经连接了一个显示器的工具。把这个工具插到显卡的hdmi接口之后，显示器的分辨率最高就到了4k。



---

> 作者: hideDragon  
> URL: https://fantasyplayer.link/periphery/esxi%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E7%9A%84%E6%93%8D%E4%BD%9C/  


<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Peripheries on Fanstasy Player / 幻想系玩家</title>
    <link>https://fantasyplayer.link/periphery/</link>
    <description>Recent content in Peripheries on Fanstasy Player / 幻想系玩家</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Mon, 14 Sep 2020 20:38:01 +0800</lastBuildDate>
    
	<atom:link href="https://fantasyplayer.link/periphery/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>在bash脚本中拼接参数的问题</title>
      <link>https://fantasyplayer.link/periphery/%E5%9C%A8bash%E8%84%9A%E6%9C%AC%E4%B8%AD%E6%8B%BC%E6%8E%A5%E5%8F%82%E6%95%B0%E7%9A%84%E9%97%AE%E9%A2%98/</link>
      <pubDate>Mon, 14 Sep 2020 20:38:01 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/%E5%9C%A8bash%E8%84%9A%E6%9C%AC%E4%B8%AD%E6%8B%BC%E6%8E%A5%E5%8F%82%E6%95%B0%E7%9A%84%E9%97%AE%E9%A2%98/</guid>
      <description>在脚本里面使用rsync 这个命令的时候， 需要根据文件的情况动态的给予参数，所以考虑使用变量来实现这个需求。
笔者刚开始在做这件事的时候碰到了一个比较蛋疼的事情。
拼接的参数会自动使用一个引号括起来， rsync 识别不到那么多参数， 好像只是识别到了第一个，后面的都被忽略掉了。
我刚开始好像是使用一个单一的变量来尝试控制参数。（大约1，2个月以前的东西​，记得不是很清楚😂)
# 本部分代码没有经过测试， 只是给个示例来说明一下。 include_arg=&amp;#39;--include=&amp;#34;*.jar&amp;#34;&amp;#39; # 如果本地存在 config.json 文件， 就发送过去 if [[ test -e &amp;#34;$folder/config.json&amp;#34; ]] then include_arg=&amp;#39;$include_arg --include=&amp;#34;*config.json&amp;#34;&amp;#39; fi sshpass -e rsync -avz &amp;#34;$include_arg&amp;#34; --exclude=&amp;#34;*&amp;#34; ./ root@xx:/root 上述代码中， 最后一段里面的 &amp;quot;$include_arg&amp;quot; 变量，经过我的测试，基本都会被解释成&amp;quot;--include=*.jar --include=*config.json&amp;quot; 。
这个参数肯定是有问题的，rsync识别不出来。
经过在stackOverflow 上的搜索，发现使用数组可以处理掉这个问题。
代码修改成如下所示的情况， 就可以正常使用了。
# 本部分代码没有经过测试， 只是给个示例来说明一下。 include_arg=(--include=&amp;#34;*.jar&amp;#34; --include=&amp;#34;lib&amp;#34;) # 如果本地存在 config.json 文件， 就发送过去 if [[ test -e &amp;#34;$folder/config.json&amp;#34; ]] then include_arg+=(--include=&amp;#34;*config.json&amp;#34;) fi sshpass -e rsync -avz &amp;#34;${include_arg[@]}&amp;#34; --exclude=&amp;#34;*&amp;#34; .</description>
    </item>
    
    <item>
      <title>家里的网络图示</title>
      <link>https://fantasyplayer.link/periphery/%E5%AE%B6%E9%87%8C%E7%9A%84%E7%BD%91%E7%BB%9C%E5%9B%BE%E7%A4%BA/</link>
      <pubDate>Sat, 29 Aug 2020 12:55:39 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/%E5%AE%B6%E9%87%8C%E7%9A%84%E7%BD%91%E7%BB%9C%E5%9B%BE%E7%A4%BA/</guid>
      <description>图示 其他说明 我家里就一台二手服务器,所有的虚拟机都在这台服务器里。
pfSense 的作用  pppoe 拨号上网 DHCP 服务  推送的网关为 192.168.200.2 即 openwrt的地址， 而非pfSense自身的地址。 推送的 dns 服务器为192.168.200.33 即debian-work的地址，而非pfSense的地址。   squid 透明缓存静态资源 | 估计图片，视频比较多把。。 但是我目前只能缓存 http 的。httpds 的则会被跳过。 DNS 服务器  主要是自己家里用的域名解析 然后再请求外部的 DNS 服务器    openwrt 的作用  旁路由 科学上网  debian-work 的作用  主要使用 docker 放一些服务 (mysql/redis/xxx...) nextcloud 类似owncloud 。 用于外网可访问的私人存储服务，我主要存储些流程图，思维导图，代码 之类的。 pi-hole 是一个按照域名阻止广告的服务， 但是好像没啥用。 这个还能做域名黑名单，防止其他人浏览， 但是我一个人住， 这个对我来说也没啥用。 git 服务， gogs是我在外网使用的服务， 里面主要存储一些小的代码库。 gitlab则是我在家里的使用的服务， 一般用于存储unity的项目， 里面的资源文件比较多。  openmediavalut 的作用  充当 NAS 。 家里的主要存储服务 主要存储游戏，电影，系统镜像，软件镜像等的内容 开启 苹果的文件协议，支持 TimeMachine 进行备份。 开启 SMB 协议， 支持这个协议的电脑，手机 都可以访问里面的文件。 （小米投影仪也支持） PLEX ，安装了之后可以在外网看家里的电影， 但是清晰度似乎不是很好。  win10下载机 &amp;amp;&amp;amp; win7 游戏机  没啥好说的， 下载就是 百度云，迅雷等。 显卡直通之后就可以使用 虚拟机玩游戏了， 我目前用模拟器玩玩手游稍多一点。我使用 anydesk 远程， 但是感觉效果不是很理想。  DNS 的链路  使用DHCP 获取地址的设备，默认 DNS 服务器都是 debian-work debian-work里的服务是pi-hole 在提供， pi-hole的上游 DNS 服务器为openwrt openwrt则是有两个 dns 服务，一个是dnsmasq,另外一个是clash 。 dnsmasq 的请求被设置成转发给clash 。 clash的上游服务器有 N 个， 其中有一个是pfSense ，这样的话， 就可以提供本地域名的解析了。  参考阅读 软路由上的DNS使用记录</description>
    </item>
    
    <item>
      <title>关于在docker中的gitlab,添加ssh key后无法推送的问题</title>
      <link>https://fantasyplayer.link/periphery/%E5%85%B3%E4%BA%8E%E5%9C%A8docker%E4%B8%AD%E7%9A%84gitlab%E6%B7%BB%E5%8A%A0ssh-key%E5%90%8E%E6%97%A0%E6%B3%95%E6%8E%A8%E9%80%81%E7%9A%84%E9%97%AE%E9%A2%98/</link>
      <pubDate>Mon, 17 Aug 2020 10:52:13 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/%E5%85%B3%E4%BA%8E%E5%9C%A8docker%E4%B8%AD%E7%9A%84gitlab%E6%B7%BB%E5%8A%A0ssh-key%E5%90%8E%E6%97%A0%E6%B3%95%E6%8E%A8%E9%80%81%E7%9A%84%E9%97%AE%E9%A2%98/</guid>
      <description>在使用unity的时候， 经常需要推送一些大的资源文件到项目里面， 使用http的方式，就会出现一些错误， 被拒绝。 我在谷歌转了几圈之后发现，大多人都推荐使用ssh的方式推送，这样也不需要用户名和密码。
我按照常规方式配置好ssh key之后，竟然无法推送。应该是提示了 “ssh: connect to host port 22: Connection refused”。
经过调试，我发现 我的gitlab 是装在docker里面的。
22端口是我的debian 虚拟机的sshd 服务在使用， 而不是gitlab 容器在使用。
所以我在git客户端上指定一下gitlab的端口 就好了。
参考下面的命令：
git remote add origin ssh://user@host:1234/srv/git/example
 1234 是端口号， 修改成你使用的即可。 user 是gitlab的用户名 host 是gitlab所在的主机 在gitlab的项目主界面， 把HTTP切换成SSH 就可以得到SSH的地址， 然后添加下端口应该就可以了。  </description>
    </item>
    
    <item>
      <title>Esxi显卡直通的操作</title>
      <link>https://fantasyplayer.link/periphery/esxi%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E7%9A%84%E6%93%8D%E4%BD%9C/</link>
      <pubDate>Fri, 31 Jul 2020 23:46:23 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/esxi%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E7%9A%84%E6%93%8D%E4%BD%9C/</guid>
      <description>这个是一个不是很难的操作， 但是执行起来可能需要踩一些坑。
ESXi 的操作 登录后台，点击管理， 找到硬件， 把显卡和 显卡的HDMI 音频都切换直通， 之后重启(重新引导)ESXi 主机。
把显卡和显卡的HDMI 音频设备添加到虚拟机里面。（编辑 / 添加 PCI-E设备）
编辑虚拟机的配置， 添加或者设置 这个配置项： hypervisor.cpuid.v0 = FALSE
虚拟机的操作 打开虚拟机， 进入系统，关闭和禁用vm-tools （这个会阻碍显卡驱动）
安装显卡驱动， 重启。
如果是 Windows 系统， 可以考虑使用 远程桌面链接这个工具链接系统， 查看显卡驱动有无成功安装。
局域网设备也可以考虑AnyDesk 这个工具。
安装显卡驱动的时候可能没那么容易成功。。。 需要点耐心。
~~如果打不开虚拟机或者全部弄好了之后，可以考虑使用 vga.present = FALSE 禁用 ESXi提供的显卡。~~加了之后我就打不开了。。。 不知道为啥😂😂😂
至此，应该 就可以正常使用了。</description>
    </item>
    
    <item>
      <title>关于linux扩充分区的随笔</title>
      <link>https://fantasyplayer.link/periphery/%E5%85%B3%E4%BA%8Elinux%E6%89%A9%E5%85%85%E5%88%86%E5%8C%BA%E7%9A%84%E9%9A%8F%E7%AC%94/</link>
      <pubDate>Sun, 19 Jul 2020 10:52:13 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/%E5%85%B3%E4%BA%8Elinux%E6%89%A9%E5%85%85%E5%88%86%E5%8C%BA%E7%9A%84%E9%9A%8F%E7%AC%94/</guid>
      <description>简介 之前给OpenMediaVault的硬盘空间不够大， 新增硬盘似乎不太方便， 就考虑扩大硬盘空间， 踩了坑之后终于弄好了。
有下面的要点， 先简单提一下。
 MBR 分区表最大只能支持2TB 空间大小 GPT 分区表能支持 大于2TB 的空间 fdisk 这个工具似乎也只能支持2TB 空间大小 parted 这个工具支持大于2TB 空间的  流程 大概思路有两个，如下所说。
 使用 fdisk 的操作流程。
 谨慎操作， 这个流程有可能让你的数据全部丢失！ 查看原有分区的 扇区数， 并记录起始扇区位置。一个磁盘只有一个分区的话，起始位置一般是2048 。 确保要扩充的分区后面没有别的分区， 否则建议新建一个分区。 删除要扩充的分区。 新建一个同类型的分区 起始扇区位置 和前面查询到的 要保持一致。 一定要保持一致，否则数据会丢 结束扇区填写， 好像可以填写具体的大小(500G这种)。 给的默认结束扇区应该是整个磁盘的空间（前提是空间小于2TB） 保存 并写入分区表 resize2fs 命令 把分区同步到文件系统。   使用parted命令 （建议）
 输入命令 parted [dev] dev 表示设备位置,一般是 /dev/sdx print 查看磁盘分区表 resizepart 1 Y 3848GB 命令扩大1号分区的空间大小  1 按需填写位置 Y 表示自动确认 3848GB 表示具体大小   quit 退出即可。 上一部应该会自动写入分区表 可查看空间大小有无更新， 没有的话可以尝试resize2fs 更新一下  </description>
    </item>
    
    <item>
      <title>软路由上的DNS使用记录</title>
      <link>https://fantasyplayer.link/periphery/%E8%BD%AF%E8%B7%AF%E7%94%B1%E4%B8%8A%E7%9A%84dns%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</link>
      <pubDate>Thu, 09 Jul 2020 20:25:06 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/%E8%BD%AF%E8%B7%AF%E7%94%B1%E4%B8%8A%E7%9A%84dns%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</guid>
      <description>简述  软路由系统： pfSense 使用的 DNS 服务： DNS Resolver 可以考虑的 DNS 服务： BIND DNS  笔者曾经成功的设置好了 BIND DNS ,但是最近这次的安装，怎么都无法成功设置， 所以就尝试了下自带的DNS Resolver ，非常简单，一次搞定。
详细内容 DNS Resolver pfSense 自带这个包，而且这个是默认启用的服务，不需要安装新的 package。
点击导航栏的Services / DNS Resolver / General Settings 即可打开常规设置的面板。
向下拉取， 找到 Host Overrides 的字样， 点击下面的 + Add 按钮。
比如我现在想添加 owncloud.home.link	192.168.200.33 这样的一条记录。
 Host: owncloud Domain: home.link IP Address: 192.168.200.33 Description: owncloud 如果你有另外一个域名也指向 192.168.200.33 比如 blog.home.link 那么可以在 Additional Names for this Host 里面直接追加 Host name: blog Domain: home.</description>
    </item>
    
    <item>
      <title>ESXi更换硬盘的记录</title>
      <link>https://fantasyplayer.link/periphery/esxi%E6%9B%B4%E6%8D%A2%E7%A1%AC%E7%9B%98%E7%9A%84%E8%AE%B0%E5%BD%95/</link>
      <pubDate>Thu, 09 Jul 2020 20:24:27 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/esxi%E6%9B%B4%E6%8D%A2%E7%A1%AC%E7%9B%98%E7%9A%84%E8%AE%B0%E5%BD%95/</guid>
      <description>简述 家里使用的服务器，主要硬盘消耗是 openmediavault。
就是一个文件存储服务， 可以用来放电影，音乐，漫画等， 还可以支持TimeMachine。
因为存储的电影越来越多， 所以准备扩大下磁盘， 踩了点坑之后，成功更换了硬盘。
（个人来说 会每周六晚上看一部电影，看完的也没删，所以比较费空间 😂）
本文使用的步骤是冷迁移，笔者是个菜鸡，暂时没有用到 vCenter
详细步骤 （冷迁移） 简述就是，关闭并移动虚拟机， 然后卸掉旧硬盘， 使用 U 盘重新安装 ESXi，并恢复配置。
注：迁移系统的话，才需要重装。
我现在有3块硬盘
 2T 得硬盘， 里面放了系统和部分虚拟机 4T 得硬盘， 里面全是虚拟机 12T 得硬盘， 新买的，目标硬盘。  步骤大概分为下面几步应该就 OK 了。
 链接新的硬盘到现在的 ESXi 主机上。SATA 或者 NVME 应该都可以，只要 能识别就 OK。记得关机操作。。 开机后，登录 web 控制面板， 基于新的硬盘创建一个数据存储  左侧导航器其次选择存储 / 数据存储 / 新建数据存储 创建新的 VMFS 存储 给一个名称， 比如 _12T_ 选择该硬盘， 版本上似乎 5和6都可以。   关闭位于想更换硬盘上的所有虚拟机。  如果分区是基于两块硬盘创建得， 则可以将全部的虚拟机移动过去 比如我的分区1 是基于一块2T 的硬盘， 一块4T 的硬盘， 我就是把全部的虚拟机关闭移动的。   打开数据浏览存储器， 进行移动  左侧导航栏依次选择 存储 / 数据存储 / 数据存储浏览器 此时会看到两个及以上的数据存储区域， 点开一个之后，里面的每一个文件夹基本都是一个虚拟机。 点击文件夹，点击移动， 目标选择新的硬盘对应的存储区域 (_12T_) 静静等待完成就可以了。 笔者移动了大概6TB 的文件， 花了差不多24~36个小时，笔者是普通的机械硬盘。   拆除不需要的硬盘。。  把想要拆掉的硬盘排除掉。 比如 一个数据区域里面两个硬盘的话，则考虑选择不需要的硬盘，或者是需要的硬盘，点击删除分区表， 之后该硬盘就会从数据分区中移出，但是笔者不知道这么做有没有什么副作用。。 如果该硬盘对应着一个数据区域，则先把该区域删除掉，再删除分区表。   如果你不需要迁移系统的话， 这时应该已经 OK 了， 重新注册下虚拟机应该就差不多要成功了。  一般情况下， 再 『我已复制』 和『我已移动』 中 你应该选择『我已复制』 否则的话，可能虚拟机就无法启动了。 但是点击我已复制，网卡的 MAC 地址会变化，初除此之外应该还有别的变化。 我第一个虚拟机 pfSense ，点击的『我已移动』 之后就没能成功启动 😹😹😹 ​ 点了之后， 虚拟机的基本配置也没办法修改， 不知道为啥。。   接下来是如果你需要迁移系统的操作。  为什么要迁移系统？ 原因当然很简单啦， 因为系统装在了一块小的硬盘上。 机箱里没更多放硬盘的位置了。   导出 当前的 ESXi 的主机配置。  官方文档： https://kb.</description>
    </item>
    
    <item>
      <title>pfSense 软路由的使用</title>
      <link>https://fantasyplayer.link/periphery/%E8%BD%AF%E8%B7%AF%E7%94%B1%E7%9A%84%E4%BD%BF%E7%94%A8/</link>
      <pubDate>Sat, 27 Jun 2020 20:49:31 +0800</pubDate>
      
      <guid>https://fantasyplayer.link/periphery/%E8%BD%AF%E8%B7%AF%E7%94%B1%E7%9A%84%E4%BD%BF%E7%94%A8/</guid>
      <description>简述  软路由系统: pfSense， 基于FreeBSD 软路由是放在 esxi上的一个虚拟机 使用电信拨号上网 LAN 口1 192.168.200.0/24 自用 LAN 口2 192.168.100.0/24 因某些原因分享网络给其他一起合租的租客使用。  开始 我现在是电信1000M/100M 的宽带， 之前使用的不到300块钱的 TPLink 路由器在 speedtest.cn 上只能跑700M 左右的下行。 更换了之后能跑到1000M 左右， 感觉还是 OK 的。
ESXI 没有使用虚拟机的读者可以跳过这一部分。
我目前的情况是这样的
 pfSense 作为主路由  其他虚拟机 我的无线路由器  我的 PC 台式机 我的无线设备， 笔记本电脑，平板，手机等   千兆交换机1  其他租客1的路由 其他租客2的路由      因为不知道博客的主题是否支持流程图就先用这种表达方式了。
新建 VMkernel 网卡 我本来是使用的别的路由， 现在的 esxi 的管理地址是192.168.0.23 ， 我更换为pfSense 之后，就没这个网段了， 所以需要处理下 esxi 的 web 管理地址的问题。</description>
    </item>
    
  </channel>
</rss>